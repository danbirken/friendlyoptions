<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<title>Friendly Options</title>

        <!-- Latest compiled and minified CSS -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">

        <!-- Optional theme -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">

        <style>
            .dotted-under {
                border-bottom: 1px dotted #AAA;
                text-decoration: none;
            }
            input[type=range] {
              -webkit-appearance: none;
              width: 100%;
              margin: 7.3px 0;
            }
            input[type=range]:focus {
              outline: none;
            }
            input[type=range]::-webkit-slider-runnable-track {
              width: 100%;
              height: 11.4px;
              cursor: pointer;
              box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
              background: rgba(48, 113, 169, 0.78);
              border-radius: 1.3px;
              border: 0.2px solid #010101;
            }
            input[type=range]::-webkit-slider-thumb {
              box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
              border: 1.8px solid #00001e;
              height: 26px;
              width: 26px;
              border-radius: 15px;
              background: #ffffff;
              cursor: pointer;
              -webkit-appearance: none;
              margin-top: -7.5px;
            }
            input[type=range]:focus::-webkit-slider-runnable-track {
              background: rgba(59, 134, 199, 0.78);
            }
            input[type=range]::-moz-range-track {
              width: 100%;
              height: 11.4px;
              cursor: pointer;
              box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
              background: rgba(48, 113, 169, 0.78);
              border-radius: 1.3px;
              border: 0.2px solid #010101;
            }
            input[type=range]::-moz-range-thumb {
              box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
              border: 1.8px solid #00001e;
              height: 26px;
              width: 26px;
              border-radius: 15px;
              background: #ffffff;
              cursor: pointer;
            }
            input[type=range]::-ms-track {
              width: 100%;
              height: 11.4px;
              cursor: pointer;
              background: transparent;
              border-color: transparent;
              color: transparent;
            }
            input[type=range]::-ms-fill-lower {
              background: rgba(39, 92, 137, 0.78);
              border: 0.2px solid #010101;
              border-radius: 2.6px;
              box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            }
            input[type=range]::-ms-fill-upper {
              background: rgba(48, 113, 169, 0.78);
              border: 0.2px solid #010101;
              border-radius: 2.6px;
              box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
            }
            input[type=range]::-ms-thumb {
              box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
              border: 1.8px solid #00001e;
              height: 26px;
              width: 26px;
              border-radius: 15px;
              background: #ffffff;
              cursor: pointer;
              height: 11.4px;
            }
            input[type=range]:focus::-ms-fill-lower {
              background: rgba(48, 113, 169, 0.78);
            }
            input[type=range]:focus::-ms-fill-upper {
              background: rgba(59, 134, 199, 0.78);
            }
        </style>

    </head>

	<body>
		<div class="container">
            <a href="https://github.com/danbirken/friendlyoptions"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

			<div class="starter-template">
				<h1>Friendly Options</h1>
				<p class="lead" style="margin-bottom: 5px;">Better understand your stock option grants.</p>
                <p class="text-muted">While every effort has been made to ensure everything on this site is accurate, treat it as advisory and please consult a lawyer or <a href="https://www.scribd.com/doc/55945011/An-Introduction-to-Stock-Options-for-the-Tech-Entrepreneur-or-Startup-Employee">other stock option guides</a> to confirm what you see here.
			</div>

            <div id="fullForm">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            Required Info
                        </h3>
                    </div>
                
                    <div class="panel-body">
                        <p>
                            In order to begin to evaluate a stock option grant, every piece of
                            information in this section is required.  Some of it will be found in
                            your specific stock option grant and some of the information will be
                            found in the general stock option plan for all employees.
                        </p>
                        <hr>
                        <form class="form-horizontal">
                            <div class="form-group" id="numOptionsError">
                                <label for="numOptions" class="col-sm-4 control-label">Number of options</label>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="numOptions">
                                </div>
                            </div>

                            <div class="form-group" id="numDilutedSharesError">
                                <label for="numDilutedShares" class="col-sm-4 control-label">Total Fully Diluted Outstanding Shares</label>
                                <div class="col-sm-8">
                                    <input type="number" class="form-control" id="numDilutedShares">
                                </div>
                            </div>

                            <div class="form-group" id="strikePriceError">
                                <label class="col-sm-4 control-label" for="strikePrice">Strike Price</label>
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <div class="input-group-addon">$</div>
                                        <input type="number" class="form-control" id="strikePrice">
                                    </div>
                                </div>
                            </div>
                            <hr>
                            <div class="form-group" id="numVestingMonthsError">
                                <label class="col-sm-4 control-label" for="numVestingMonths">Total Vesting Period</label>
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="numVestingMonths">
                                        <div class="input-group-addon">months</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group" id="numVestingCliffError">
                                <label class="col-sm-4 control-label" for="numVestingCliff">Initial Vesting Cliff</label>
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="numVestingCliff">
                                        <div class="input-group-addon">months</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group" id="optionTypeError">
                                <label class="col-sm-4 control-label" for="optionType">Type of options</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline">
                                        <input type="radio" name="optionType" id="optionTypeISO" value="ISO"> ISO <a href="https://en.wikipedia.org/wiki/Incentive_stock_option">(info)</a>
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="optionType" id="optionTypeNSO" value="NSO"> NSO <a href="https://en.wikipedia.org/wiki/Non-qualified_stock_option">(info)</a>
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="optionType" id="optionTypeHybrid" value="ISO/NSO Hybrid"> ISO/NSO Hybrid
                                    </label>
                                </div>
                            </div>

                            <div class="form-group" id="optionsExpireValueError">
                                <label class="col-sm-4 control-label" for="optionsExpireValue">Options expiration</label>
                                <div class="col-sm-2">
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="optionsExpireValue">
                                    </div>
                                </div>
                                <div class="col-sm-6 can-have-error" id="optionsExpireScaleError">
                                    <div class="input-group">
                                        <label class="radio-inline">
                                            <input type="radio" name="optionsExpireScale" id="optionsExpireScaleDays" value="days"> Days</a>
                                        </label>
                                        <label class="radio-inline">
                                            <input type="radio" name="optionsExpireScale" id="optionsExpireScaleYears" value="years"> Years</a>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="earlyExercise">Early Exercise</label>
                                <div class="col-sm-8">
                                    <div class="checkbox">
                                        <label>
                                            <input type="checkbox" id="earlyExercise"> Early exercise of options are allowed
                                        </label>
                                    </div>
                                    
                                </div>
                            </div>
                            

                        </form>
                    </div>
                </div>

                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            Optional Info
                        </h3>
                    </div>
                
                    <div class="panel-body" id="valuationForm">
                        <p>
                            This information is optional, but it will help to estimate potential
                            outcomes for your stock options.  Approximations and guesses are fine.
                        </p>
                        <hr>
                        <form class="form-horizontal">
                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="totalValuation">Current Valuation</label>
                                <div class="col-sm-8">
                                    <div class="input-group">
                                        <div class="input-group-addon">$</div>
                                        <input type="number" class="form-control" id="totalValuation">
                                        <div class="input-group-addon">million(s)</div>
                                    </div>
                                </div>
                            </div>

                            <div class="form-group">
                                <label class="col-sm-4 control-label" for="companyStage">Most Recent Completed Funding Round</label>
                                <div class="col-sm-8">
                                    <label class="radio-inline">
                                        <input type="radio" name="companyStage" id="companyStagePreSeed" value="preSeed"> No funding
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="companyStage" id="companyStageSeed" value="seed"> Seed
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="companyStage" id="companyStageAngel" value="angel"> Angel
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="companyStage" id="companyStageSeriesA" value="seriesA"> Series A
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="companyStage" id="companyStageSeriesB" value="seriesB"> Series B/C/D/+
                                    </label>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
                           
            <div class="row" id="formSubmitGroup">
                <div class="form-group">
                    <div class="col-sm-offset-4 col-sm-8">
                        <button type="submit" id="formSubmit" class="btn btn-default">Generate Report</button>
                    </div>
                </div>
            </div>


            <div class="row" id="formSlideDownGroup" style="display:none;">
                <div class="col-sm-12">
                    <div id="staticForm"></div>
                    <div class="form-group">
                        <div class="col-sm-offset-4 col-sm-8">
                            <button type="submit" id="formSlideDownSubmit" class="btn btn-default">Adjust Information</button>
                        </div>
                    </div>
                </div>
            </div>

            <hr>

            <div class="row" id="report">
                <div class="col-sm-12">
                    <div id="adjust"></div>
                </div>
                <div class="col-sm-12">
                    <div id="result"></div>
                </div>
            </div>

		</div><!-- /.container -->

		<!-- Bootstrap core JavaScript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

        <!-- Latest compiled and minified JavaScript -->
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>

        <script src="vendor/nunjucks.min.js"></script>
        <script src="vendor/accounting.min.js"></script>
        <script src="vendor/jquery.scrollTo.min.js"></script>

        <link href="vendor/tipr/tipr.css" rel="stylesheet">
        <script src="vendor/tipr/tipr.min.js"></script>

        <script>
            $(document).ready(function () {
                var parseForm = function() {
                    var numOptions = parseInt($('#numOptions').val(), 10);
                    var strikePrice = parseFloat($('#strikePrice').val(), 10);
                    var numDilutedShares = parseInt($('#numDilutedShares').val(), 10);
                    var numVestingMonths = parseInt($('#numVestingMonths').val(), 10);
                    var numVestingCliff = parseInt($('#numVestingCliff').val(), 10);
                    var optionType = $('input[name=optionType]:checked').val();
                    var earlyExercise = $('#earlyExercise').is(':checked');

                    var optionsExpireValue = parseInt($('#optionsExpireValue').val(), 10);
                    var optionsExpireScale = $('input[name=optionsExpireScale]:checked').val();

                    var optionsExpireEmployeeFriendly = (
                        optionsExpireValue >= 5 &&
                        optionsExpireScale == 'years'
                    );

                    var totalValuation = parseFloat($('#totalValuation').val(), 10);
                    var companyStage = $('input[name=companyStage]:checked').val();
                    
                    optionObj = {
                        numOptions: numOptions,
                        strikePrice: strikePrice,
                        numDilutedShares: numDilutedShares,
                        numVestingMonths: numVestingMonths,
                        numVestingCliff: numVestingCliff,
                        optionType: optionType,
                        optionsExpireValue: optionsExpireValue,
                        optionsExpireScale: optionsExpireScale,
                        optionsExpireEmployeeFriendly: optionsExpireEmployeeFriendly,
                        earlyExercise: earlyExercise,
                        totalValuation: totalValuation,
                        companyStage: companyStage
                    }

                    var requiredNumberFields = [
                        'numOptions', 'strikePrice', 'numDilutedShares', 'numVestingMonths',
                        'numVestingCliff', 'optionsExpireValue',
                    ];

                    var errorFields = [];

                    for (i in requiredNumberFields) {
                        if (isNaN(optionObj[requiredNumberFields[i]])) {
                            errorFields.push(requiredNumberFields[i]);
                        }
                    }

                    if ($.inArray(optionObj.optionType, ['ISO', 'NSO', 'ISO/NSO Hybrid']) == -1) {
                        errorFields.push('optionType');
                    }

                    if ($.inArray(optionObj.earlyExercise, [true, false]) == -1) {
                        errorFields.push('earlyExercise');
                    }

                    if ($.inArray(optionObj.optionsExpireScale, ['days', 'years']) == -1) {
                        errorFields.push('optionsExpireScale');
                    }

                    if (errorFields.length) {
                        highlightErrors(errorFields);
                        return null;
                    } else {
                        clearHighlightErrors();
                        return optionObj;
                    }
                }

                var parseLocation = function() {
                    if (window.location.hash) {
                        return JSON.parse(decodeURIComponent(window.location.hash.substring(1)));
                    } else {
                        return null;
                    }
                }

                var updateLocation = function(optionObj) {
                    window.location.hash = '#' + encodeURIComponent(JSON.stringify(optionObj));
                }

                var updateForm = function(optionObj) {
                    $('#numOptions').val(optionObj.numOptions);
                    $('#strikePrice').val(optionObj.strikePrice);
                    $('#numDilutedShares').val(optionObj.numDilutedShares);
                    $('#numVestingMonths').val(optionObj.numVestingMonths);
                    $('#numVestingCliff').val(optionObj.numVestingCliff);
                    $('#optionsExpireValue').val(optionObj.optionsExpireValue);
                    $('#totalValuation').val(optionObj.totalValuation);

                    $('#earlyExercise').prop('checked', optionObj.earlyExercise);

                    checkbox_fields = [
                        ['optionType', optionObj.optionType],
                        ['optionsExpireScale', optionObj.optionsExpireScale],
                        ['companyStage', optionObj.companyStage]
                    ];

                    $.each(checkbox_fields, function(i, field) {
                        if (field[1]) {
                            $('input[name=' + field[0] + ']').prop('checked', false);
                            $('input[name=' + field[0] + '][value="' + field[1] + '"]').prop(
                                'checked', true
                            );
                        }
                    });
                }

                var parseAdjustForm = function() {
                    numMonthsAtCompany = parseInt($('#numMonthsAtCompany').val(), 10);

                    return {
                        numMonthsAtCompany: numMonthsAtCompany,
                    }
                }

                var analyze = function(optionObj, adjustObj) {
                    if (adjustObj.numMonthsAtCompany < optionObj.numVestingCliff) {
                        vestedShares = 0;
                    } else {
                        vestedShares = Math.floor(
                            optionObj.numOptions *
                            (adjustObj.numMonthsAtCompany / optionObj.numVestingMonths)
                        )
                    }

                    companyPercent = vestedShares / optionObj.numDilutedShares;
                    exerciseCost = vestedShares * optionObj.strikePrice;

                    if (optionObj.totalValuation) {
                        totalValuation = optionObj.totalValuation * 1000000;
                    } else {
                        totalValuation = null;
                    }

                    return {
                        numMonthsAtCompany: adjustObj.numMonthsAtCompany,
                        companyPercent: companyPercent,
                        companyBasis: companyPercent * 10000,
                        exerciseCost: exerciseCost,
                        totalValuation: totalValuation
                    }
                }

                var valuationScenario = function(analyzeObj, increaseMultiple, dilutionMultiple) {
                    companyValue = (
                        analyzeObj.totalValuation *
                        increaseMultiple
                    );
                    optionValue = companyValue * analyzeObj.companyPercent * dilutionMultiple;

                    return {
                        companyValue: companyValue,
                        optionValue: optionValue,
                        optionProfit: optionValue - analyzeObj.exerciseCost
                    };
                }

                var clearHighlightErrors = function() {
                    $('div.form-group').removeClass('has-error');
                    $('div.can-have-error').removeClass('has-error');
                }

                var highlightErrors = function(errorFields) {
                    clearHighlightErrors();
                    for (i in errorFields) {
                        $('#' + errorFields[i] + 'Error').addClass('has-error');
                    }
                    $(window).scrollTo($('#' + errorFields[0] + 'Error'), 500);
                }

                var env = new nunjucks.Environment(new nunjucks.WebLoader('views'))
                env.addGlobal('valuationScenario', valuationScenario);
                env.addGlobal('inArray', function (a, b) {
                    return $.inArray(a, b) != -1;
                });
                env.addFilter('money', accounting.formatMoney);

                $(document).on('click', '#formEditValuationSubmit', function(e) {
                    e.preventDefault();
                    $('#fullForm').show(0);
                    $('#formSubmitGroup').show(0);
                    $('#formSlideDownGroup').hide(0);
                    $(window).scrollTo($('#valuationForm'), 500);
                });

                $(document).on('click', '#formSlideDownSubmit', function(e) {
                    e.preventDefault();
                    $('#fullForm').show(0);
                    $('#formSubmitGroup').show(0);
                    $('#formSlideDownGroup').hide(0);
                    $(window).scrollTo($('#fullForm'), 500);
                });

                $(document).on('click', '#formSubmit', function(e) {
                    e.preventDefault();

                    var optionObj = parseForm();

                    if (optionObj == null) {
                        return;
                    }

                    updateLocation(optionObj);

                    $('#fullForm').hide(0);
                    $('#formSubmitGroup').hide(0);
                    $('#formSlideDownGroup').show(0);

                    $('#staticForm').html(
                        env.render(
                            'staticForm.html',
                            {
                                optionObj: optionObj
                            }
                        )
                    );

                    $('#adjust').html(
                        env.render(
                            'adjustments.html',
                            {
                                optionObj: optionObj
                            }
                        )
                    );

                    adjustObj = parseAdjustForm();
                    analyzeObj = analyze(optionObj, adjustObj);

                    $('#result').html(
                        env.render(
                            'report.html',
                            {
                                optionObj: optionObj,
                                analyzeObj: analyzeObj,
                            }
                        )
                    );

                    $(window).scrollTo($('#reportStart'), 500);
                });

                $(document).on('change', 'input.update-results-form', function() {
                    var optionObj = parseForm();

                    if (optionObj == null) {
                        return;
                    }

                    var adjustObj = parseAdjustForm();

                    var analyzeObj = analyze(optionObj, adjustObj);

                    $('#result').html(
                        env.render(
                            'report.html',
                            {
                                optionObj: optionObj,
                                analyzeObj: analyzeObj,
                            }
                        )
                    );
                });

                var initialOptionObj = parseLocation();
                if (initialOptionObj) {
                    updateForm(initialOptionObj);
                    $('#formSubmit').click();
                }
            });
        </script>
	</body>
</html>

